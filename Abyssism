//Abyssism Kit ~ 2014 Kioni ®

ModPE.setFoodItem(367, "rotten_flesh", 0, 1, "Rotten Flesh");

function useItem(x, y, z, itemId, blockId, side, itemDamage, blockDamage)
{
if(itemId==367 && blockId==120)
{
addItemInventory(367, -1);
addItemInventory(87, 1);
var hth = Entity.getHealth(getPlayerEnt());
Entity.setHealth(getPlayerEnt(), hth + 2);
}
}

function attackHook(attacker,victim)
{

if(Entity.getEntityTypeId(victim)!=34 && Entity.getEntityTypeId(victim)!=64 && Entity.getEntityTypeId(victim)!=65 && Entity.getEntityTypeId(victim)!=66 && Entity.getEntityTypeId(victim)!=80 && Entity.getEntityTypeId(victim)!=81 && Entity.getEntityTypeId(victim)!=82 && Entity.getEntityTypeId(victim)!=83 && Entity.getEntityTypeId(victim)!=84)
{

var xx = Entity.getX(victim);
var yy = Entity.getY(victim);
var zz = Entity.getZ(victim);

setTile(xx, yy, zz, 35, 14);
{

Level.destroyBlock(xx, yy, zz, false)
}

}
}

function deathHook(murderer, victim, x, y, z)
{ 
     var mx = Entity.getX(victim);
     var my = Entity.getY(victim);
     var mz = Entity.getZ(victim);

     if(Entity.getEntityTypeId(victim)!=34 && Entity.getEntityTypeId(victim)!=64 && Entity.getEntityTypeId(victim)!=65 && Entity.getEntityTypeId(victim)!=66 && Entity.getEntityTypeId(victim)!=80 && Entity.getEntityTypeId(victim)!=81 && Entity.getEntityTypeId(victim)!=82 && Entity.getEntityTypeId(victim)!=83 && Entity.getEntityTypeId(victim)!=84)
     {
     var fleshdeath = Math.floor((Math.random()*3)+1);
if(fleshdeath == 3) {
         Level.dropItem(mx, my, mz, 1, 367, 1, 0);
     }
     }
}

var sprintTick = 1;

var spon = 1;

var activity = com.mojang.minecraftpe.MainActivity.currentMainActivity.get();

var buttonWindow = null;

var button = new android.widget.Button(activity);



function newLevel()

{

activity.runOnUiThread(new java.lang.Runnable({ run: function() {

    

        try { 

          buttonWindow = new android.widget.PopupWindow();

          

          var layout = new android.widget.RelativeLayout(activity);


          

          button.setText("~"); 

          

          button.setOnClickListener(new android.view.View.OnClickListener({

                

                onClick: function(viewarg) {

                    if(spon == 1)

                      {

                        spon = 2;

                        clientMessage("Sprint On");

                      }

                    else if(spon == 2)

                      {

                         spon = 1;

                         clientMessage("Sprint Off");

                      }


                  }

          }));

          layout.addView(button);

          buttonWindow.setContentView(layout);

          buttonWindow.setWidth(android.widget.RelativeLayout.LayoutParams.WRAP_CONTENT);

          buttonWindow.setHeight(android.widget.RelativeLayout.LayoutParams.WRAP_CONTENT);

          

          buttonWindow.setBackgroundDrawable(new

android.graphics.drawable.ColorDrawable(android.graphics.Color.BLACK));

          

          buttonWindow.showAtLocation(activity.getWindow().getDecorView(), android.view.Gravity.CENTER | android.view.Gravity.TOP, 0, 0);

          }catch(problem){

          print("Button could not be displayed: " + problem); //Print our error if we failed to make the button

        }

  }}));

}


function modTick()

{

if(spon == 2)

{

if(sprintTick == 1) {

			Xpos = Player.getX();

			Zpos = Player.getZ();

			sprintTick++;

		} if(sprintTick == 3) {

			sprintTick = 1;

			Xdiff = Player.getX() - Xpos;

			Zdiff = Player.getZ() - Zpos;

			Entity.setVelX(Player.getEntity(),Xdiff);

			Entity.setVelZ(Player.getEntity(),Zdiff);

			Xdiff = 0;

			Zdiff = 0;

		} if(sprintTick != 1) {

			sprintTick++;

		}

}else if(spon == 1)

{

  sprintTick = 1;

}

}


function leaveGame()

{

var activity = com.mojang.minecraftpe.MainActivity.currentMainActivity.get();

  activity.runOnUiThread(new java.lang.Runnable({ run: function() {

        if(buttonWindow != null) { 

          buttonWindow.dismiss(); 

          buttonwindow = null;

        }

  }}));

}
